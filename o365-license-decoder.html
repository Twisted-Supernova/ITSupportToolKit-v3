<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office 365 License Decoder - IT Support Toolkit</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">IT Support Toolkit</div>
            <button class="burger-menu" id="burgerMenu" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div class="nav-menu" id="navMenu">
            <a href="index.html">Home</a>
            
            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">Generators ▾</button>
                <div class="nav-dropdown-content">
                    <a href="password-generator.html">Password Generator</a>
                    <a href="username-generator.html">Username Generator</a>
                </div>
            </div>

            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">Network Tools ▾</button>
                <div class="nav-dropdown-content">
                    <a href="ip-lookup.html">IP Lookup</a>
                    <a href="port-reference.html">Port Reference</a>
                    <a href="mac-lookup.html">MAC Lookup</a>
                    <a href="dns-lookup.html">DNS Lookup</a>
                    <a href="whois-lookup.html">WHOIS Lookup</a>
                </div>
            </div>

            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">Data Tools ▾</button>
                <div class="nav-dropdown-content">
                    <a href="hash-generator.html">Hash Generator</a>
                    <a href="json-formatter.html">JSON Formatter</a>
                    <a href="encoder-decoder.html">Encoder/Decoder</a>
                    <a href="timestamp-converter.html">Timestamp Converter</a>
                    <a href="o365-license-decoder.html" class="active">O365 License Decoder</a>
                </div>
            </div>

            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">System Tools ▾</button>
                <div class="nav-dropdown-content">
                    <a href="error-lookup.html">Error Lookup</a>
                    <a href="ntfs-builder.html">NTFS Permission Builder</a>
                    <a href="firewall-builder.html">Firewall Rule Builder</a>
                    <a href="flowcharts.html">Troubleshooting Flowcharts</a>
                    <a href="mfa-troubleshooting.html">MFA/CA Troubleshooting</a>
                    <a href="remote-session-builder.html">Remote Session Builder</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="tool-header">
            <h1>Office 365 License Decoder</h1>
            <p>Decode cryptic SKU codes into readable Microsoft 365 license names</p>
        </div>

        <div class="tool-content">
            <div class="search-section">
                <input type="text" id="searchInput" placeholder="Enter SKU code (e.g., ENTERPRISEPACK) or search by name..." class="search-input">
                <div class="button-group">
                    <button class="btn" onclick="showAllLicenses()">Show All Licenses</button>
                    <button class="btn-secondary" onclick="clearSearch()">Clear</button>
                    <button class="btn-secondary" onclick="exportToCSV()">Export CSV</button>
                </div>
            </div>

            <div class="filter-tabs">
                <button class="filter-btn active" data-filter="all">All (<span id="count-all">0</span>)</button>
                <button class="filter-btn" data-filter="enterprise">Enterprise (<span id="count-enterprise">0</span>)</button>
                <button class="filter-btn" data-filter="business">Business (<span id="count-business">0</span>)</button>
                <button class="filter-btn" data-filter="frontline">Frontline (<span id="count-frontline">0</span>)</button>
                <button class="filter-btn" data-filter="education">Education (<span id="count-education">0</span>)</button>
            </div>

            <div id="results" class="results-grid">
                <div class="no-results">
                    <p>Enter a SKU code or license name to search, or click "Show All Licenses"</p>
                </div>
            </div>

            <div class="info-box">
                <h3>PowerShell Commands for License Management</h3>
                <div class="command-box">
<pre># Connect to Microsoft Graph
Connect-MgGraph -Scopes "Organization.Read.All"

# Get all available licenses in your tenant
Get-MgSubscribedSku | Select SkuPartNumber, SkuId, ConsumedUnits

# Get user's assigned licenses
Get-MgUserLicenseDetail -UserId user@domain.com | Select SkuPartNumber

# Export all users with their licenses
Get-MgUser -All | Select DisplayName, UserPrincipalName, AssignedLicenses</pre>
                    <button class="copy-btn" onclick="copyCommand()">Copy</button>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 IT Support Toolkit</p>
    </footer>

    <script src="script.js"></script>
    <script>
        // License database
        const licenses = [
            // Microsoft 365 Enterprise
            { sku: 'SPE_E5', name: 'Microsoft 365 E5', category: 'enterprise', description: 'Complete enterprise solution with advanced security, compliance, and analytics' },
            { sku: 'SPE_E3', name: 'Microsoft 365 E3', category: 'enterprise', description: 'Core enterprise productivity and security' },
            { sku: 'ENTERPRISEPREMIUM', name: 'Office 365 E5', category: 'enterprise', description: 'Office 365 enterprise with advanced features' },
            { sku: 'ENTERPRISEPACK', name: 'Office 365 E3', category: 'enterprise', description: 'Core Office 365 enterprise suite' },
            { sku: 'STANDARDPACK', name: 'Office 365 E1', category: 'enterprise', description: 'Web-based Office apps and services' },
            { sku: 'SPE_F1', name: 'Microsoft 365 F1', category: 'frontline', description: 'Frontline worker solution' },
            { sku: 'SPE_F3', name: 'Microsoft 365 F3', category: 'frontline', description: 'Frontline worker with Office apps' },
            
            // Microsoft 365 Business
            { sku: 'SPB', name: 'Microsoft 365 Business Premium', category: 'business', description: 'Complete small business solution' },
            { sku: 'O365_BUSINESS_PREMIUM', name: 'Microsoft 365 Business Standard', category: 'business', description: 'Business productivity and collaboration' },
            { sku: 'O365_BUSINESS_ESSENTIALS', name: 'Microsoft 365 Business Basic', category: 'business', description: 'Web-based apps for business' },
            { sku: 'SMB_BUSINESS', name: 'Microsoft 365 Apps for Business', category: 'business', description: 'Office desktop apps for business' },
            
            // Office Apps
            { sku: 'OFFICESUBSCRIPTION', name: 'Microsoft 365 Apps for Enterprise', category: 'enterprise', description: 'Office desktop apps (formerly Office 365 ProPlus)' },
            { sku: 'PROJECTPROFESSIONAL', name: 'Project Plan 5', category: 'enterprise', description: 'Project Online Professional' },
            { sku: 'PROJECTESSENTIALS', name: 'Project Plan 3', category: 'enterprise', description: 'Project Online Essentials' },
            { sku: 'VISIOCLIENT', name: 'Visio Plan 2', category: 'enterprise', description: 'Visio Online Plan 2' },
            { sku: 'VISIOONLINE_PLAN1', name: 'Visio Plan 1', category: 'enterprise', description: 'Visio web app' },
            
            // Security & Compliance
            { sku: 'THREAT_INTELLIGENCE', name: 'Microsoft Defender for Office 365 Plan 2', category: 'enterprise', description: 'Advanced threat protection' },
            { sku: 'ATP_ENTERPRISE', name: 'Microsoft Defender for Office 365 Plan 1', category: 'enterprise', description: 'Basic threat protection' },
            { sku: 'EMS', name: 'Enterprise Mobility + Security E5', category: 'enterprise', description: 'Complete identity and access management' },
            { sku: 'EMSPREMIUM', name: 'Enterprise Mobility + Security E3', category: 'enterprise', description: 'Core identity and device management' },
            { sku: 'AAD_PREMIUM', name: 'Azure Active Directory Premium P1', category: 'enterprise', description: 'Identity and access management' },
            { sku: 'AAD_PREMIUM_P2', name: 'Azure Active Directory Premium P2', category: 'enterprise', description: 'Advanced identity protection' },
            { sku: 'INTUNE_A', name: 'Microsoft Intune', category: 'enterprise', description: 'Device and app management' },
            { sku: 'INFORMATION_PROTECTION_COMPLIANCE', name: 'Microsoft 365 E5 Compliance', category: 'enterprise', description: 'Advanced compliance tools' },
            
            // Communication
            { sku: 'MCOSTANDARD', name: 'Microsoft Teams Essentials', category: 'business', description: 'Standalone Teams license' },
            { sku: 'MCOEV', name: 'Microsoft 365 Phone System', category: 'enterprise', description: 'Cloud-based phone system' },
            { sku: 'MCOMEETADV', name: 'Microsoft 365 Audio Conferencing', category: 'enterprise', description: 'Dial-in conferencing' },
            { sku: 'TEAMS_COMMERCIAL_TRIAL', name: 'Microsoft Teams Commercial Trial', category: 'business', description: 'Teams trial license' },
            
            // Exchange
            { sku: 'EXCHANGESTANDARD', name: 'Exchange Online Plan 1', category: 'enterprise', description: '50GB mailbox' },
            { sku: 'EXCHANGEENTERPRISE', name: 'Exchange Online Plan 2', category: 'enterprise', description: '100GB mailbox with archiving' },
            { sku: 'EXCHANGEARCHIVE_ADDON', name: 'Exchange Online Archiving', category: 'enterprise', description: 'Email archiving add-on' },
            { sku: 'EXCHANGEDESKLESS', name: 'Exchange Online Kiosk', category: 'frontline', description: 'Basic email for frontline workers' },
            
            // SharePoint & OneDrive
            { sku: 'SHAREPOINTSTANDARD', name: 'SharePoint Online Plan 1', category: 'enterprise', description: 'Basic SharePoint' },
            { sku: 'SHAREPOINTENTERPRISE', name: 'SharePoint Online Plan 2', category: 'enterprise', description: 'Advanced SharePoint' },
            { sku: 'ONEDRIVESTANDARD', name: 'OneDrive for Business Plan 1', category: 'enterprise', description: '1TB storage' },
            { sku: 'ONEDRIVE_BASIC', name: 'OneDrive for Business Basic', category: 'business', description: 'Basic cloud storage' },
            
            // Power Platform
            { sku: 'POWER_BI_PRO', name: 'Power BI Pro', category: 'enterprise', description: 'Business analytics and reporting' },
            { sku: 'POWER_BI_PREMIUM', name: 'Power BI Premium', category: 'enterprise', description: 'Advanced analytics platform' },
            { sku: 'POWERAPPS_PER_USER', name: 'Power Apps per User', category: 'enterprise', description: 'Custom app development' },
            { sku: 'FLOW_FREE', name: 'Power Automate Free', category: 'business', description: 'Basic workflow automation' },
            
            // Dynamics 365
            { sku: 'DYN365_ENTERPRISE_SALES', name: 'Dynamics 365 Sales Enterprise', category: 'enterprise', description: 'Sales force automation' },
            { sku: 'DYN365_ENTERPRISE_CUSTOMER_SERVICE', name: 'Dynamics 365 Customer Service', category: 'enterprise', description: 'Customer service management' },
            { sku: 'DYN365_TEAM_MEMBERS', name: 'Dynamics 365 Team Members', category: 'enterprise', description: 'Basic Dynamics access' },
            
            // Education
            { sku: 'STANDARDWOFFPACK_FACULTY', name: 'Office 365 A1 for Faculty', category: 'education', description: 'Free for educators' },
            { sku: 'STANDARDWOFFPACK_STUDENT', name: 'Office 365 A1 for Students', category: 'education', description: 'Free for students' },
            { sku: 'ENTERPRISEPREMIUM_FACULTY', name: 'Office 365 A5 for Faculty', category: 'education', description: 'Premium education license' },
            { sku: 'ENTERPRISEPREMIUM_STUDENT', name: 'Office 365 A5 for Students', category: 'education', description: 'Premium student license' },
            { sku: 'M365EDU_A3_FACULTY', name: 'Microsoft 365 A3 for Faculty', category: 'education', description: 'Education enterprise suite' },
            { sku: 'M365EDU_A3_STUDENT', name: 'Microsoft 365 A3 for Students', category: 'education', description: 'Student enterprise suite' },
            
            // Windows
            { sku: 'WIN10_PRO_ENT_SUB', name: 'Windows 10/11 Enterprise E3', category: 'enterprise', description: 'Windows Enterprise subscription' },
            { sku: 'WIN10_VDA_E5', name: 'Windows 10/11 Enterprise E5', category: 'enterprise', description: 'Windows Enterprise E5' }
        ];

        let currentFilter = 'all';
        let displayedLicenses = [];

        // Initialize counts
        function updateCounts() {
            const counts = {};
            licenses.forEach(l => {
                counts[l.category] = (counts[l.category] || 0) + 1;
            });
            
            document.getElementById('count-all').textContent = licenses.length;
            document.getElementById('count-enterprise').textContent = counts.enterprise || 0;
            document.getElementById('count-business').textContent = counts.business || 0;
            document.getElementById('count-frontline').textContent = counts.frontline || 0;
            document.getElementById('count-education').textContent = counts.education || 0;
        }

        updateCounts();

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                displayResults([]);
                return;
            }

            const results = licenses.filter(license => {
                const matchesSearch = license.sku.toLowerCase().includes(searchTerm) ||
                       license.name.toLowerCase().includes(searchTerm) ||
                       license.description.toLowerCase().includes(searchTerm);
                const matchesCategory = currentFilter === 'all' || license.category === currentFilter;
                return matchesSearch && matchesCategory;
            });

            displayResults(results);
        });

        function displayResults(results) {
            displayedLicenses = results;
            const resultsDiv = document.getElementById('results');

            if (results.length === 0) {
                resultsDiv.innerHTML = '<div class="no-results"><p>No licenses found matching your search.</p></div>';
                return;
            }

            let html = '';
            results.forEach(license => {
                html += `
                    <div class="license-card">
                        <h3>${license.name}</h3>
                        <div class="sku-code">${license.sku}</div>
                        <span class="badge badge-${license.category}">${license.category.toUpperCase()}</span>
                        <p class="license-description">${license.description}</p>
                    </div>
                `;
            });

            resultsDiv.innerHTML = html;
        }

        function showAllLicenses() {
            displayResults(currentFilter === 'all' ? licenses : licenses.filter(l => l.category === currentFilter));
            document.getElementById('searchInput').value = '';
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            displayResults([]);
        }

        // Filter functionality
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const filter = this.dataset.filter;
                currentFilter = filter;
                
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
                
                if (searchTerm !== '') {
                    const results = licenses.filter(license => {
                        const matchesSearch = license.sku.toLowerCase().includes(searchTerm) ||
                               license.name.toLowerCase().includes(searchTerm) ||
                               license.description.toLowerCase().includes(searchTerm);
                        const matchesCategory = filter === 'all' || license.category === filter;
                        return matchesSearch && matchesCategory;
                    });
                    displayResults(results);
                } else {
                    const filtered = filter === 'all' ? licenses : licenses.filter(l => l.category === filter);
                    displayResults(filtered);
                }
            });
        });

        function exportToCSV() {
            const dataToExport = displayedLicenses.length > 0 ? displayedLicenses : licenses;
            
            let csv = 'SKU Code,License Name,Category,Description\n';
            dataToExport.forEach(license => {
                csv += `"${license.sku}","${license.name}","${license.category}","${license.description}"\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'office365_licenses.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function copyCommand() {
            const commandBox = document.querySelector('.command-box pre');
            const text = commandBox.textContent;

            navigator.clipboard.writeText(text).then(() => {
                const btn = commandBox.nextElementSibling;
                btn.textContent = 'Copied!';
                setTimeout(() => {
                    btn.textContent = 'Copy';
                }, 2000);
            });
        }
    </script>
</body>
</html>
