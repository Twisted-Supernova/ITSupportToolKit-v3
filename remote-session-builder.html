<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remote Session Command Builder - IT Support Toolkit</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">IT Support Toolkit</div>
            <button class="burger-menu" id="burgerMenu" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div class="nav-menu" id="navMenu">
            <a href="index.html">Home</a>
            
            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">Generators ▾</button>
                <div class="nav-dropdown-content">
                    <a href="password-generator.html">Password Generator</a>
                    <a href="username-generator.html">Username Generator</a>
                </div>
            </div>

            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">Network Tools ▾</button>
                <div class="nav-dropdown-content">
                    <a href="ip-lookup.html">IP Lookup</a>
                    <a href="port-reference.html">Port Reference</a>
                    <a href="mac-lookup.html">MAC Lookup</a>
                    <a href="dns-lookup.html">DNS Lookup</a>
                    <a href="whois-lookup.html">WHOIS Lookup</a>
                </div>
            </div>

            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">Data Tools ▾</button>
                <div class="nav-dropdown-content">
                    <a href="hash-generator.html">Hash Generator</a>
                    <a href="json-formatter.html">JSON Formatter</a>
                    <a href="encoder-decoder.html">Encoder/Decoder</a>
                    <a href="timestamp-converter.html">Timestamp Converter</a>
                    <a href="o365-license-decoder.html">O365 License Decoder</a>
                </div>
            </div>

            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">System Tools ▾</button>
                <div class="nav-dropdown-content">
                    <a href="error-lookup.html">Error Lookup</a>
                    <a href="ntfs-builder.html">NTFS Permission Builder</a>
                    <a href="firewall-builder.html">Firewall Rule Builder</a>
                    <a href="flowcharts.html">Troubleshooting Flowcharts</a>
                    <a href="mfa-troubleshooting.html">MFA/CA Troubleshooting</a>
                    <a href="remote-session-builder.html" class="active">Remote Session Builder</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="tool-header">
            <h1>Remote Session Command Builder</h1>
            <p>Generate commands for PSExec, Remote PowerShell, and RDP sessions</p>
        </div>

        <div class="tool-content">
            <div class="section-tabs">
                <button class="tab-btn active" data-tab="psexec">PSExec</button>
                <button class="tab-btn" data-tab="powershell">Remote PowerShell</button>
                <button class="tab-btn" data-tab="rdp">RDP</button>
            </div>

            <!-- PSExec Tab -->
            <div id="psexec" class="tab-content active">
                <div class="form-group">
                    <label>Remote Computer Name or IP:</label>
                    <input type="text" id="psexec-computer" placeholder="PC-NAME or 192.168.1.100">
                </div>

                <div class="form-group">
                    <label>Username (optional - leave blank for system account):</label>
                    <input type="text" id="psexec-username" placeholder="DOMAIN\Username">
                </div>

                <div class="form-group">
                    <label>Command to Execute:</label>
                    <input type="text" id="psexec-command" placeholder="cmd.exe" value="cmd.exe">
                </div>

                <div class="checkbox-group">
                    <label><input type="checkbox" id="psexec-system" checked> Run as SYSTEM</label>
                    <label><input type="checkbox" id="psexec-interactive" checked> Interactive mode</label>
                    <label><input type="checkbox" id="psexec-elevated"> Run elevated (admin)</label>
                    <label><input type="checkbox" id="psexec-copy"> Force copy PSExec</label>
                </div>

                <button class="btn" onclick="generatePSExec()">Generate Command</button>

                <div class="output-section">
                    <div class="command-box">
                        <pre id="psexec-output">Command will appear here...</pre>
                        <button class="copy-btn" onclick="copyOutput('psexec-output')">Copy</button>
                    </div>
                </div>

                <div class="info-box">
                    <h3>PSExec Quick Reference</h3>
                    <ul>
                        <li><strong>-s</strong> - Run as SYSTEM account</li>
                        <li><strong>-i</strong> - Interactive mode (opens GUI on remote system)</li>
                        <li><strong>-h</strong> - Run with elevated token</li>
                        <li><strong>-u</strong> - Specify username</li>
                        <li><strong>-p</strong> - Specify password (will prompt if omitted)</li>
                        <li><strong>-c</strong> - Copy executable to remote system</li>
                        <li><strong>-f</strong> - Force copy even if file exists</li>
                    </ul>
                    <p><strong>Download:</strong> <a href="https://learn.microsoft.com/sysinternals/downloads/psexec" target="_blank">Microsoft Sysinternals</a></p>
                </div>
            </div>

            <!-- PowerShell Tab -->
            <div id="powershell" class="tab-content">
                <div class="form-group">
                    <label>Remote Computer Name or IP:</label>
                    <input type="text" id="ps-computer" placeholder="PC-NAME or 192.168.1.100">
                </div>

                <div class="form-group">
                    <label>Connection Type:</label>
                    <select id="ps-type">
                        <option value="enter">Enter-PSSession (Interactive)</option>
                        <option value="invoke">Invoke-Command (Run Command)</option>
                        <option value="new">New-PSSession (Persistent)</option>
                    </select>
                </div>

                <div class="form-group" id="ps-command-group" style="display: none;">
                    <label>Command to Execute:</label>
                    <input type="text" id="ps-command" placeholder="Get-Service">
                </div>

                <div class="checkbox-group">
                    <label><input type="checkbox" id="ps-credential"> Use alternate credentials</label>
                    <label><input type="checkbox" id="ps-ssl"> Use SSL (HTTPS)</label>
                    <label><input type="checkbox" id="ps-auth"> Specify CredSSP authentication</label>
                </div>

                <button class="btn" onclick="generatePowerShell()">Generate Command</button>

                <div class="output-section">
                    <div class="command-box">
                        <pre id="ps-output">Command will appear here...</pre>
                        <button class="copy-btn" onclick="copyOutput('ps-output')">Copy</button>
                    </div>
                </div>

                <div class="info-box">
                    <h3>PowerShell Remoting Setup</h3>
                    <ul>
                        <li><strong>Enable on remote PC:</strong> <code>Enable-PSRemoting -Force</code></li>
                        <li><strong>Trust hosts:</strong> <code>Set-Item WSMan:\localhost\Client\TrustedHosts -Value "*"</code></li>
                        <li><strong>Test connection:</strong> <code>Test-WSMan -ComputerName PC-NAME</code></li>
                        <li><strong>Default Ports:</strong> HTTP (5985), HTTPS (5986)</li>
                    </ul>
                </div>
            </div>

            <!-- RDP Tab -->
            <div id="rdp" class="tab-content">
                <div class="form-group">
                    <label>Remote Computer Name or IP:</label>
                    <input type="text" id="rdp-computer" placeholder="PC-NAME or 192.168.1.100">
                </div>

                <div class="form-group">
                    <label>Username (optional):</label>
                    <input type="text" id="rdp-username" placeholder="DOMAIN\Username">
                </div>

                <div class="form-group">
                    <label>Screen Size:</label>
                    <select id="rdp-size">
                        <option value="fullscreen">Full Screen</option>
                        <option value="1920x1080">1920x1080</option>
                        <option value="1600x900">1600x900</option>
                        <option value="1366x768">1366x768</option>
                        <option value="1280x720">1280x720</option>
                        <option value="800x600">800x600</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <label><input type="checkbox" id="rdp-admin" checked> Console session (/admin)</label>
                    <label><input type="checkbox" id="rdp-multimon"> Use all monitors</label>
                    <label><input type="checkbox" id="rdp-public"> Public mode (no caching)</label>
                    <label><input type="checkbox" id="rdp-restricted"> Restricted Admin mode</label>
                </div>

                <button class="btn" onclick="generateRDP()">Generate Command</button>

                <div class="output-section">
                    <div class="command-box">
                        <pre id="rdp-output">Command will appear here...</pre>
                        <button class="copy-btn" onclick="copyOutput('rdp-output')">Copy</button>
                    </div>
                </div>

                <div class="info-box">
                    <h3>RDP Command Line Options</h3>
                    <ul>
                        <li><strong>/v:</strong> Specify computer to connect to</li>
                        <li><strong>/admin</strong> - Connect to console session</li>
                        <li><strong>/f</strong> - Start in full screen mode</li>
                        <li><strong>/w: /h:</strong> Screen width and height</li>
                        <li><strong>/public</strong> - Runs RDP in public mode (no caching)</li>
                        <li><strong>/multimon</strong> - Use multiple monitors</li>
                        <li><strong>/restrictedAdmin</strong> - Connect in Restricted Admin mode</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 IT Support Toolkit</p>
    </footer>

    <script src="script.js"></script>
    <script>
        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Show/hide command field for PowerShell Invoke-Command
        document.getElementById('ps-type').addEventListener('change', function() {
            const commandGroup = document.getElementById('ps-command-group');
            commandGroup.style.display = this.value === 'invoke' ? 'block' : 'none';
        });

        function generatePSExec() {
            const computer = document.getElementById('psexec-computer').value.trim();
            const username = document.getElementById('psexec-username').value.trim();
            const command = document.getElementById('psexec-command').value.trim();
            const isSystem = document.getElementById('psexec-system').checked;
            const isInteractive = document.getElementById('psexec-interactive').checked;
            const isElevated = document.getElementById('psexec-elevated').checked;
            const forceCopy = document.getElementById('psexec-copy').checked;

            if (!computer) {
                document.getElementById('psexec-output').textContent = 'Please enter a computer name or IP address.';
                return;
            }

            let cmd = `psexec \\\\${computer}`;
            
            if (username && !isSystem) {
                cmd += ` -u ${username} -p *`;
            }
            if (isSystem) cmd += ' -s';
            if (isInteractive) cmd += ' -i';
            if (isElevated) cmd += ' -h';
            if (forceCopy) cmd += ' -c -f';
            
            cmd += ` ${command}`;

            document.getElementById('psexec-output').textContent = cmd;
        }

        function generatePowerShell() {
            const computer = document.getElementById('ps-computer').value.trim();
            const type = document.getElementById('ps-type').value;
            const command = document.getElementById('ps-command').value.trim();
            const useCredential = document.getElementById('ps-credential').checked;
            const useSSL = document.getElementById('ps-ssl').checked;
            const useCredSSP = document.getElementById('ps-auth').checked;

            if (!computer) {
                document.getElementById('ps-output').textContent = 'Please enter a computer name or IP address.';
                return;
            }

            let cmd = '';
            if (useCredential) cmd = '$cred = Get-Credential\n';

            switch(type) {
                case 'enter':
                    cmd += `Enter-PSSession -ComputerName ${computer}`;
                    break;
                case 'invoke':
                    if (!command) {
                        document.getElementById('ps-output').textContent = 'Please enter a command to execute.';
                        return;
                    }
                    cmd += `Invoke-Command -ComputerName ${computer} -ScriptBlock {${command}}`;
                    break;
                case 'new':
                    cmd += `$session = New-PSSession -ComputerName ${computer}`;
                    break;
            }

            if (useCredential) cmd += ' -Credential $cred';
            if (useSSL) cmd += ' -UseSSL';
            if (useCredSSP) cmd += ' -Authentication CredSSP';

            document.getElementById('ps-output').textContent = cmd;
        }

        function generateRDP() {
            const computer = document.getElementById('rdp-computer').value.trim();
            const username = document.getElementById('rdp-username').value.trim();
            const size = document.getElementById('rdp-size').value;
            const isAdmin = document.getElementById('rdp-admin').checked;
            const isMultimon = document.getElementById('rdp-multimon').checked;
            const isPublic = document.getElementById('rdp-public').checked;
            const isRestricted = document.getElementById('rdp-restricted').checked;

            if (!computer) {
                document.getElementById('rdp-output').textContent = 'Please enter a computer name or IP address.';
                return;
            }

            let cmd = `mstsc /v:${computer}`;

            if (isAdmin) cmd += ' /admin';
            
            if (size === 'fullscreen') {
                cmd += ' /f';
            } else {
                const dimensions = size.split('x');
                cmd += ` /w:${dimensions[0]} /h:${dimensions[1]}`;
            }

            if (isMultimon) cmd += ' /multimon';
            if (isPublic) cmd += ' /public';
            if (isRestricted) cmd += ' /restrictedAdmin';

            let output = cmd;
            if (username) output += `\n\n# When prompted, enter username: ${username}`;

            document.getElementById('rdp-output').textContent = output;
        }

        function copyOutput(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;

            navigator.clipboard.writeText(text).then(() => {
                const btn = element.nextElementSibling;
                btn.textContent = 'Copied!';
                setTimeout(() => {
                    btn.textContent = 'Copy';
                }, 2000);
            });
        }
    </script>
</body>
</html>
